<!DOCTYPE html>
<html>
  <head>
    <!-- EXTERNAL LIBS-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://www.google.com/jsapi"></script>
    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <!-- EXAMPLE SCRIPT -->
    <script>
    //window.onload = function () {
      var socket = io();
      

      // onload callback
      function drawChart() {
        
      var data = new google.visualization.DataTable();

      data.addColumn('number', 'Time');
      data.addColumn('number', 'rsi');
      data.addColumn('number', 'column');

        // data.addRows([
        //   [0, 11, 13],
        //   [1, 21, 18],
        //   [2, 1, 14],
        //   [3, 15, 11],
        //   [4, 12, 16]
        // ]);
        var chart = new google.visualization.LineChart($('#chart').get(0));

      socket.on('chat message', function(msg){
        console.log(msg);
        data.addRow([msg.time, msg.rss, msg.dist]);
        $('#messages').append($('<li>').text(msg.time + ' ' + msg.rss + ' ' + msg.dist));
        chart.draw(data, {
          title: 'DA'
        });
      });

        chart.draw(data, {
          title: 'DA',
          curveType: 'function'
        });
      }

      // load chart lib
      google.load('visualization', '1', {
        packages: ['corechart']
      });

      // call drawChart once google charts is loaded
      google.setOnLoadCallback(drawChart);
  //}

    </script>

  </head>
  <body>

    <div id="chart" style="width: 100%; height: 500px"></div>
          <ul id="messages"></ul>

  </body>
</html>